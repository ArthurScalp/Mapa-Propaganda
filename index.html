<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Mapa Publicit√°rio - Santana do Acara√∫</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <style>
    body { margin:0; font-family: Arial, Helvetica, sans-serif; }
    .topbar {
      height:auto; display:flex; flex-wrap:wrap; gap:12px; align-items:center; padding:10px 20px;
      background:#2c3e50; color:#fff; font-size:18px; font-weight:bold;
      position:relative; z-index:1000;
    }
    .topbar input[type="text"]{ padding:6px; font-size:15px; width:120px; border-radius:4px; border:1px solid #ccc; }
    .topbar button { padding:6px 12px; font-size:15px; cursor:pointer; border:none; border-radius:4px; font-weight:bold; }
    .btn-saude { background:#27ae60; color:#fff; }       
    .btn-alim { background:#e67e22; color:#000; }       
    .btn-serv { background:#f1c40f; color:#000; }       
    .btn-com { background:#4073f5; color:#fff; }        
    .btn-saude:hover { background:#1e8449; }
    .btn-alim:hover { background:#ca6f1e; }
    .btn-serv:hover { background:#d4ac0d; }
    .btn-com:hover { background:#305fd1; }
    #btnSearch, #btnList { background:#86878a; color:#fff; }
    #btnSearch:hover, #btnList:hover { background:#6c6d70; }
    #map { position:absolute; top:50px; left:0; right:0; bottom:0; z-index:1; }
    #bottombar {
      position:absolute; bottom:0; left:0; right:0; height:150px; background:rgba(0,0,0,0.5); 
      display:flex; overflow-x:auto; padding:10px; gap:10px; align-items:center; z-index:500;
      pointer-events:auto; scroll-behavior:smooth;
    }
    .store-item { 
      flex:0 0 auto; text-align:center; opacity:0; transition: opacity 0.6s ease-in-out;
      background:rgba(255,255,255,0.9); border-radius:6px; padding:6px;
    }
    .store-item.show { opacity:1; }
    .store-logo { width:120px; border-radius:6px; margin-bottom:6px; }
    .store-btn { display:block; margin:4px 0; padding:5px 8px; background:#3498db; color:#fff; border-radius:6px; text-decoration:none; font-size:14px; }
    .store-btn:hover { background:#2980b9; }
    .store-btn.whatsapp { background:#27ae60; }
    .store-btn.whatsapp:hover { background:#1e8449; }
  </style>
</head>
<body>
  <div class="topbar">
    üìç Mapa Publicit√°rio
    <label for="q" style="margin-left:16px;">Loja:</label>
    <input id="q" type="text" placeholder="ex: 16" />
    <button id="btnSearch">Buscar</button>
    <button id="btnList">Todas</button>
    <button class="btn-saude" id="btnSaude">Sa√∫de</button>
    <button class="btn-alim" id="btnAlim">Alimenta√ß√£o</button>
    <button class="btn-serv" id="btnServ">Servi√ßos</button>
    <button class="btn-com" id="btnCom">Com√©rcio</button>
  </div>

  <div id="bottombar"></div>
  <div id="map"></div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    const stores = [
      { id:"01", lat:-3.458989, lng:-40.211312, whatsapp:"5588999320315", category:"Sa√∫de" },
      { id:"02", lat:-3.461124, lng:-40.208692, whatsapp:"5588999612096", category:"Sa√∫de" },
      { id:"03", lat:-3.459921, lng:-40.211520, whatsapp:"5588999966746", category:"Sa√∫de" },
      { id:"04", lat:-3.461348, lng:-40.209577, whatsapp:"5588993335636", category:"Sa√∫de" },
      { id:"05", lat:-3.459998, lng:-40.211163, whatsapp:"5588993758322", category:"Sa√∫de" },
      { id:"06", lat:-3.460786, lng:-40.208148, whatsapp:"5588997238535", category:"Sa√∫de" },
      { id:"07", lat:-3.461756, lng:-40.209153, whatsapp:"5588996832954", category:"Sa√∫de" },
      { id:"08", lat:-3.460285, lng:-40.211196, whatsapp:"5588996555900", category:"Sa√∫de" },
      { id:"11", lat:-3.460895, lng:-40.209753, whatsapp:"5588999015503", category:"Sa√∫de" },
      { id:"12", lat:-3.460743, lng:-40.208147, whatsapp:"5588996086589", category:"Alimenta√ß√£o" },
      { id:"13", lat:-3.458361, lng:-40.211691, category:"Alimenta√ß√£o" },
      { id:"14", lat:-3.461581, lng:-40.209177, whatsapp:"5588997286037", category:"Alimenta√ß√£o" },
      { id:"15", lat:-3.458995, lng:-40.209667, whatsapp:"5588996354940", category:"Alimenta√ß√£o" },
      { id:"16", lat:-3.459405, lng:-40.206793, whatsapp:"5588996607152", category:"Alimenta√ß√£o" },
      { id:"17", lat:-3.458779, lng:-40.203935, whatsapp:"5588996401920", category:"Alimenta√ß√£o" }
      // Continue adicionando as outras lojas aqui...
    ];

    const map = L.map('map').setView([-3.4595, -40.207], 16);
    L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
      attribution:'Tiles &copy; Esri'
    }).addTo(map);

    const markers = {};
    stores.forEach(s => { markers[s.id] = L.marker([s.lat,s.lng]).addTo(map); });

    const bottombar = document.getElementById('bottombar');
    let searchTimeout;

    function showBottomStores(filtered){
      bottombar.innerHTML="";
      filtered.forEach(s=>{
        const div=document.createElement('div');
        div.className="store-item show";
        div.innerHTML=`<img src="logos/${s.id}.jpg" class="store-logo"><br>
          <a class="store-btn" href="https://www.google.com/maps/dir/?api=1&destination=${s.lat},${s.lng}" target="_blank">üìç Navega√ß√£o</a>
          ${s.whatsapp?`<a class="store-btn whatsapp" href="https://wa.me/${s.whatsapp}" target="_blank">üí¨ WhatsApp</a>`:""}`;
        bottombar.appendChild(div);
      });
    }

    function showCategory(category){
      const filtered = stores.filter(s=>s.category===category).sort((a,b)=>parseInt(a.id)-parseInt(b.id));
      showBottomStores(filtered);
    }

    document.getElementById('btnSaude').onclick=()=>showCategory('Sa√∫de');
    document.getElementById('btnAlim').onclick=()=>showCategory('Alimenta√ß√£o');
    document.getElementById('btnServ').onclick=()=>showCategory('Servi√ßos');
    document.getElementById('btnCom').onclick=()=>showCategory('Com√©rcio');

    document.getElementById('btnList').onclick=()=>showBottomStores(stores);

    document.getElementById('btnSearch').onclick=()=>{
      const q = document.getElementById('q').value.trim();
      const store = stores.find(s=>s.id===q);
      if(!store) return alert("Loja n√£o encontrada");

      L.popup()
        .setLatLng([store.lat,store.lng])
        .setContent(`<img src="logos/${store.id}.jpg" style="width:150px"><br>
          <a href="https://www.google.com/maps/dir/?api=1&destination=${store.lat},${store.lng}" target="_blank">üìç Navega√ß√£o</a>
          ${store.whatsapp?`<br><a href="https://wa.me/${store.whatsapp}" target="_blank" style="color:white;background:green;padding:4px 8px;border-radius:4px;display:inline-block;margin-top:4px;">üí¨ WhatsApp</a>`:""}`)
        .openOn(map);

      showBottomStores([store]);

      clearTimeout(searchTimeout);
      searchTimeout=setTimeout(()=>{
        map.closePopup();
        bottombar.innerHTML="";
        map.setView([-3.4595, -40.207],16);
      },10000);
    }

    // Popup aleat√≥rio a cada 10s
    setInterval(()=>{
      const s = stores[Math.floor(Math.random()*stores.length)];
      L.popup()
        .setLatLng([s.lat,s.lng])
        .setContent(`<img src="logos/${s.id}.jpg" style="width:150px"><br>
          <a href="https://www.google.com/maps/dir/?api=1&destination=${s.lat},${s.lng}" target="_blank">üìç Navega√ß√£o</a>
          ${s.whatsapp?`<br><a href="https://wa.me/${s.whatsapp}" target="_blank" style="color:white;background:green;padding:4px 8px;border-radius:4px;display:inline-block;margin-top:4px;">üí¨ WhatsApp</a>`:""}`)
        .openOn(map);
    },10000);
  </script>
</body>
</html>
